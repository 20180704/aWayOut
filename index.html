<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>è¯·å‡ç®¡ç†</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<style>

/* è®¾ç½®æ•´ä½“å­—ä½“å¤§å°ä¸º 1.5 å€ï¼ˆ1em = 16px â†’ 1.5em â‰ˆ 24pxï¼‰ */
body { 
    font-family: Arial, sans-serif; 
    margin: 0;
    padding: 0;
    font-size: 0.97em; /* å…¨å±€æ”¾å¤§ 1.5 å€ */
}

/* ç”¨æˆ·ä¿¡æ¯æ æ ·å¼ */
.user-info {
    margin-bottom: 1.25em; /* 20px â†’ 1.25em */
    display: flex;
    align-items: center;
    margin-left: 1.25em;
    margin-top: 1.25em;
}
.avatar {
    width: 2.5em; /* 40px â†’ 2.5em */
    height: 2.5em; /* 40px â†’ 2.5em */
    border-radius: 50%;
    background-color: rgb(240,245,248);
    margin-right: 0.625em; /* 10px â†’ 0.625em */
}
.user-text {
    display: inline-block;
}
.user-text h4, 
.user-text p {
    margin: 0;
}
.user-text p {
    color: gray;
    font-size: 0.9em; /* ç›¸å¯¹äº bodyï¼Œå®é™… â‰ˆ 21.6px */
}

/* å¤´éƒ¨ä¸å†…å®¹ */
.header { 
    background-color: #f0f8ff; 
    padding: 0.625em; /* 10px â†’ 0.625em */
}
.content { 
    margin: 1.25em; /* 20px â†’ 1.25em */
    /* ç§»é™¤ font-sizeï¼Œç»§æ‰¿ body */
}

.info {
    padding-left: 0em; /* 10px â†’ 0.625em */
    margin-bottom: 1.25em; /* 20px â†’ 1.25em */
}

.info, .progress {
    margin-bottom: 1.25em;
    position: relative;
    padding-left: 0em;
}

.info::before, .progress::before {
    content: '';
    position: absolute;
    left: 0;
    top: 2.5px;
    height: 1.2em; /* 24px â†’ 1.5em */
    width: 0.25em; /* 4px â†’ 0.25em */
    background-color: #007bff;
}
.progress {
    margin-top: 2em; 
}
.progress::before {
    content: '';
    position: absolute;
    left: 0;
    top: 5.1px;
    height: 1em;
    width: 0.25em;
    background-color: #007bff;
}

.stamp { 
    float: right; 
    margin-top: -3.125em; /* -50px â†’ -3.125em */
}

.info p { 
    margin: 0; 
    line-height: 1.88; 
    font-size: 0.96em; /* â‰ˆ 39.6px å®é™…å¤§å° */
}

.info span:first-child { 
    color: rgb(161, 161, 161); 
    margin-right: 0.5em;
    flex-shrink: 0;
    min-width: 5em; /* 80px â†’ 5em */
}

.progress div { 
    display: flex; 
    align-items: center; 
    margin: 0; 
    line-height: 1.7; /* å¢å¤§è¡Œé«˜ä»¥é€‚é…å¤§å­—ä½“ */
    font-size: 0.9em; /* ç»§æ‰¿ body çš„ 1.5emï¼Œå®é™… â‰ˆ 36px */
    margin-bottom: -1.1em; /* æ–°å¢ï¼šå‡å°æ­¥éª¤é—´çš„é—´è· */
}

/* è¿›åº¦å›¾æ ‡å†…æ–‡å­—ä¹Ÿæ”¹ä¸º em */
.progress .check-mark {
    display: inline-block;
    width: 1.25em; /* 20px â†’ 1.25em */
    height: 1.25em;
    border: 0.0625em solid #4b7ccb; /* 1px â†’ 0.0625em */
    border-radius: 50%;
    text-align: center;
    line-height: 1.125em; /* 18px â†’ 1.125em */
    color: #4b7ccb;
    font-size: 0.9em; /* 14px â†’ 0.875em */
    margin-right: 0.625em;
}

.progress .dot-mark {
    display: inline-block;
    width: 1.25em;
    height: 1.25em;
    border: 0.0625em solid #4b7ccb;
    border-radius: 50%;
    position: relative;
    margin-right: 0.625em;
}
.progress .dot-mark span {
    display: block;
    width: 0.5em; /* 8px â†’ 0.5em */
    height: 0.5em;
    background-color: #4b7ccb;
    border-radius: 50%;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
}
.progress h3 {
    margin-bottom: 0em;
}
/* æ—¶é—´æ–‡å­— */
.progress .time {
    margin-left: auto;
    color: #a1a1a1;
    font-size: 0.9em; /* 14px â†’ 0.875em */
}

/* è¾…åŠ©ä¿¡æ¯ */
.progress .sub-info {
    color: #a1a1a1;
    margin-left: 1.875em; /* 30px â†’ 1.875em */
    font-size: 0.9em;
    margin-top: 0.7em;
    margin-bottom: 0;
    line-height: 1;
}

.progress .sub-info-row {
    display: flex;
    justify-content: space-between;
    margin-left: 1.875em;
    margin-top: -0.1em; 
    margin-bottom: -0.5em;
    line-height: 1;
    color: #a1a1a1;
    font-size: 0.9em;
}
</style>
</head>
<!--å¼€å§‹-->






<div id="configPanel" style="display:none; position:fixed; bottom:0; left:0; right:0; background:#f8f9fa; border-top:2px solid #007bff; padding:1em; z-index:10000; max-height:70vh; overflow-y:auto; font-size:14px; box-shadow:0 -2px 10px rgba(0,0,0,0.1);">
  <h4>å‚æ•°é…ç½®</h4>
  <div id="configFields"></div>
  <button onclick="saveToLocal()" style="padding:6px 12px; background:#007bff; color:white; border:none; margin-right:8px;">ä¿å­˜é…ç½®</button>
  <button onclick="resetToDefault()" style="padding:6px 12px; background:#dc3545; color:white; border:none; margin-right:8px;">æ¢å¤é»˜è®¤</button>
  <button onclick="hidePanel()" style="padding:6px 12px; background:#6c757d; color:white; border:none;">éšè—</button>
</div>

<script>
// === é»˜è®¤é…ç½®ï¼ˆå¯ä¿®æ”¹ï¼‰===
const defaultConfig = {
  user_h4_name: "å¼ ä¸‰",
  user_p_id: "20210001",
  handler_role: "å¤§é˜Ÿé•¿",
  teacher_time: "2025-09-05 10:00",
  apply_time: "2025-09-05 10:00"
};

let longPressTimer = null;

// === åˆå§‹åŒ–é…ç½®é¢æ¿ ===
function initConfigPanel() {
  const configFields = document.getElementById('configFields');
  if (!configFields) return;

  // è¯»å–æœ¬åœ°ä¿å­˜çš„é…ç½®
  const saved = localStorage.getItem('leaveConfig');
  const data = saved ? JSON.parse(saved) : {};

  // === 1. è¯»å– .info p ä¸­çš„æ ‡ç­¾+å€¼ï¼Œç”Ÿæˆè¾“å…¥æ¡† ===
  document.querySelectorAll('.info p').forEach((p, i) => {
    const keySpan = p.querySelector('span:first-child');
    if (!keySpan) return;
    const keyLabel = keySpan.textContent.trim();
    const value = p.textContent.replace(keyLabel, '').trim();
    const inputName = `field_${i}`;
    const savedValue = data[inputName] !== undefined ? data[inputName] : value;
    createInput(inputName, keyLabel, savedValue);
  });

  // === 2. ç”¨æˆ·å§“å ===
  const h4El = document.querySelector('.user-text h4');
  const h4Val = data.user_h4_name || (h4El?.textContent?.trim() || defaultConfig.user_h4_name);
  createInput('user_h4_name', 'ç”¨æˆ·å§“å', h4Val);

  // === 3. ç”¨æˆ·å­¦å· ===
  const idEl = document.querySelector('.user-text > p:not([class])');
  const idVal = data.user_p_id || (idEl?.textContent?.trim() || defaultConfig.user_p_id);
  createInput('user_p_id', 'ç”¨æˆ·å­¦å·', idVal);

  // === 4. åŠç†äººè§’è‰²ï¼ˆå¤§é˜Ÿé•¿/è¾…å¯¼å‘˜ï¼‰===
  const roleRow = Array.from(document.querySelectorAll('.progress .sub-info-row')).find(r =>
    r.querySelector('p') && ['å¤§é˜Ÿé•¿', 'è¾…å¯¼å‘˜'].includes(r.querySelector('p').textContent.trim())
  );
  const roleEl = roleRow?.querySelector('p');
  const roleVal = data.handler_role || (roleEl?.textContent?.trim() || defaultConfig.handler_role);
  createInput('handler_role', 'åŠç†äººè§’è‰²', roleVal);

  // === 5. åŠç†æ—¶é—´ï¼ˆé€šå¸¸æ˜¯ç¬¬äºŒä¸ª .timeï¼‰===
  const timeEls = document.querySelectorAll('.progress .time');
  const teacherTimeEl = timeEls.length > 1 ? timeEls[1] : timeEls[0];
  const teacherTimeVal = data.teacher_time || (teacherTimeEl?.textContent?.trim() || defaultConfig.teacher_time);
  createInput('teacher_time', 'åŠç†æ—¶é—´', teacherTimeVal);

  // === 6. ç”³è¯·æ—¶é—´ï¼ˆæŸ¥æ‰¾åŒ…å«â€œç”³è¯·â€çš„åŒºå—ä¸­çš„ .timeï¼‰===
  const applyDivs = Array.from(document.querySelectorAll('div')).filter(div => {
    const pText = div.querySelector('p')?.textContent || '';
    return pText.includes('ç”³è¯·');
  });
  const applyTimeEl = applyDivs[0]?.querySelector('.time');
  const applyTimeVal = data.apply_time || (applyTimeEl?.textContent?.trim() || defaultConfig.apply_time);
  createInput('apply_time', 'ç”³è¯·æ—¶é—´', applyTimeVal);

  // åº”ç”¨é…ç½®åˆ°é¡µé¢
  applyConfigToPage(data);
}

// åˆ›å»ºè¾“å…¥æ¡†
function createInput(name, label, value) {
  const div = document.createElement('div');
  div.innerHTML = `
    <label>${label}:<br>
      <input type="text" name="${name}" value="${escapeHtml(value)}" 
             style="width:90%; padding:4px; margin:4px 0; font-size:14px;">
    </label><br><br>
  `;
  document.getElementById('configFields').appendChild(div);
}

// åº”ç”¨é…ç½®åˆ°é¡µé¢å…ƒç´ 
function applyConfigToPage(data) {
  // .info p å­—æ®µ
  document.querySelectorAll('.info p').forEach((p, i) => {
    const key = `field_${i}`;
    if (data[key] === undefined) return;
    const keySpan = p.querySelector('span:first-child');
    if (!keySpan) return;
    const label = keySpan.textContent.trim();
    p.innerHTML = keySpan.outerHTML + data[key];
  });

  // ç”¨æˆ·å§“å
  if (data.user_h4_name && document.querySelector('.user-text h4')) {
    document.querySelector('.user-text h4').textContent = data.user_h4_name;
  }

  // ç”¨æˆ·å­¦å·
  if (data.user_p_id) {
    const el = document.querySelector('.user-text > p:not([class])');
    if (el) el.textContent = data.user_p_id;
  }

  // åŠç†äººè§’è‰²
  const roleRow = Array.from(document.querySelectorAll('.progress .sub-info-row')).find(r =>
    r.querySelector('p') && ['å¤§é˜Ÿé•¿', 'è¾…å¯¼å‘˜'].includes(r.querySelector('p').textContent.trim())
  );
  if (data.handler_role && roleRow) {
    roleRow.querySelector('p').textContent = data.handler_role;
  }

  // åŠç†æ—¶é—´
  const timeEls = document.querySelectorAll('.progress .time');
  const teacherTimeEl = timeEls.length > 1 ? timeEls[1] : timeEls[0];
  if (data.teacher_time && teacherTimeEl) {
    teacherTimeEl.textContent = data.teacher_time;
  }

  // ç”³è¯·æ—¶é—´
  const applyDivs = Array.from(document.querySelectorAll('div')).filter(div => {
    const pText = div.querySelector('p')?.textContent || '';
    return pText.includes('ç”³è¯·');
  });
  const applyTimeEl = applyDivs[0]?.querySelector('.time');
  if (data.apply_time && applyTimeEl) {
    applyTimeEl.textContent = data.apply_time;
  }

  // è¿›åº¦æ¡ä¸­çš„ç”¨æˆ·å§“åï¼ˆsub-infoï¼‰
  if (data.user_h4_name) {
    const subInfoEl = document.querySelector('.progress .sub-info');
    if (subInfoEl) {
      subInfoEl.textContent = data.user_h4_name;
    }
  }
}

// ä¿å­˜é…ç½®
function saveToLocal() {
  const data = {};
  document.querySelectorAll('#configFields input').forEach(input => {
    data[input.name] = input.value;
  });
  localStorage.setItem('leaveConfig', JSON.stringify(data));
  alert('âœ… é…ç½®å·²ä¿å­˜ï¼åˆ·æ–°é¡µé¢åç”Ÿæ•ˆ');
  location.reload();
}

// æ¢å¤é»˜è®¤
function resetToDefault() {
  localStorage.removeItem('leaveConfig');
  alert('å·²æ¢å¤é»˜è®¤é…ç½®ï¼åˆ·æ–°é¡µé¢ç”Ÿæ•ˆ');
  location.reload();
}

// éšè—é¢æ¿
function hidePanel() {
  document.getElementById('configPanel').style.display = 'none';
}

// æ˜¾ç¤ºé¢æ¿
function showPanel() {
  document.getElementById('configPanel').style.display = 'block';
}

// === æ ¸å¿ƒï¼šç»‘å®šé•¿æŒ‰å¤´åƒè§¦å‘ ===
// === æ ¸å¿ƒï¼šé™é»˜ç»‘å®šé•¿æŒ‰å¤´åƒè§¦å‘ï¼ˆæ— è§†è§‰å˜åŒ–ï¼‰===
function setupLongPressOnAvatar() {
  // å¸¸è§å¤´åƒé€‰æ‹©å™¨ï¼ˆæŒ‰ä¼˜å…ˆçº§ï¼‰
  const selectors = [
    '.user-text .avatar',
    '.user-text > div:first-child', // ç¬¬ä¸€ä¸ª divï¼ˆå¸¸ä¸ºå¤´åƒå®¹å™¨ï¼‰
    '.user-text circle',
    '.user-text svg',
    '.avatar',
    '.profile-pic',
    '.user-text img'
  ];

  let avatar = null;
  for (const sel of selectors) {
    avatar = document.querySelector(sel);
    if (avatar) break;
  }

  if (!avatar) {
    console.warn('âš ï¸ æœªæ‰¾åˆ°å¤´åƒå…ƒç´ ï¼Œ500ms åé‡è¯•...');
    setTimeout(setupLongPressOnAvatar, 500);
    return;
  }

  // ğŸ” å®Œå…¨ä¸ä¿®æ”¹å¤–è§‚ï¼Œä¸åŠ è¾¹æ¡†ã€ä¸åŠ é˜´å½±ã€ä¸æ”¹ cursor
  // åªç»‘å®šäº‹ä»¶ï¼Œç”¨æˆ·å®Œå…¨çœ‹ä¸å‡ºåŒºåˆ«

  let longPressTimer;

  const startPress = () => {
    // é•¿æŒ‰ 3 ç§’è§¦å‘
    longPressTimer = setTimeout(() => {
      showPanel(); // å¼¹å‡ºé¢æ¿
      console.log('ğŸ¯ é•¿æŒ‰è¯†åˆ«æˆåŠŸï¼Œé…ç½®é¢æ¿å·²å¼€å¯');
    }, 3000);
  };

  const cancelPress = () => {
    if (longPressTimer) {
      clearTimeout(longPressTimer);
      longPressTimer = null;
    }
  };

  // === ç»‘å®šäº‹ä»¶ï¼ˆä¸å¹²æ‰°åŸå§‹è¡Œä¸ºï¼‰===

  // é¼ æ ‡æŒ‰ä¸‹
  avatar.addEventListener('mousedown', (e) => {
    e.preventDefault(); // é˜»æ­¢é»˜è®¤è¡Œä¸ºï¼ˆå¦‚é€‰ä¸­ï¼‰
    startPress();
  });

  // é¼ æ ‡æŠ¬èµ·æˆ–ç§»å‡ºï¼Œå–æ¶ˆè®¡æ—¶
  document.addEventListener('mouseup', cancelPress);
  document.addEventListener('mouseleave', cancelPress);

  // è§¦æ‘¸è®¾å¤‡æ”¯æŒ
  avatar.addEventListener('touchstart', (e) => {
    e.preventDefault(); // é˜»æ­¢é»˜è®¤è§¦æ‘¸è¡Œä¸º
    startPress();
  }, { passive: false });

  document.addEventListener('touchend', cancelPress);
  document.addEventListener('touchcancel', cancelPress);

  console.log('âœ… å¤´åƒé•¿æŒ‰ç›‘å¬å·²é™é»˜ç»‘å®šï¼Œå¤–è§‚æ— å˜åŒ–');
}

// é˜² XSS
function escapeHtml(text) {
  const div = document.createElement('div');
  div.textContent = text;
  return div.innerHTML;
}

// === é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ– ===
document.addEventListener('DOMContentLoaded', () => {
  // å»¶è¿Ÿæ‰§è¡Œï¼Œç¡®ä¿ DOM ç¨³å®š
  setTimeout(() => {
    initConfigPanel();           // åˆå§‹åŒ–é…ç½®é¢æ¿
    setupLongPressOnAvatar();    // ç»‘å®šå¤´åƒé•¿æŒ‰
  }, 200);
});
</script>







<!--ç»“æŸ-->
<body>
<div class="header">
    <a href="#">é¦–é¡µ</a> > åº”ç”¨ > è¯·å‡ç®¡ç† > è¯·å‡ç®¡ç†
</div>

<!-- ç”¨æˆ·ä¿¡æ¯æ  -->
<div class="user-info">
    <div class="avatar"></div>
    <div class="user-text">
        <h4>å¼ ä¸‰</h4>
        <p>20210001</p>
    </div>
</div>

<div style="height: 0.75em; background-color: #f3f4f8; margin: 0; padding: 0;"></div>

<div class="content">
    <div class="info">
        <h3 style="font-size: 1.04em; margin-left: 0.5em;">è¯·å‡ä¿¡æ¯</h3>
        <p>
    <span>è¯·å‡ç±»å‹:</span>å…¶ä»–
    <img src="pass.png" style="float: right; margin-right: 0.7em; height: 3.3em; opacity: 0.9;">
</p>
        <p><span>è¯·å‡å»å‘:</span></p>
        <p><span>è¯¦ç»†åœ°å€:</span></p>
        <p><span>å¼€å§‹æ—¶é—´:</span></p>
        <p><span>ç»“æŸæ—¶é—´:</span></p>
        <p><span>ç»Ÿè®¡æ—¶é•¿:</span>å¤©å°æ—¶åˆ†é’Ÿ</p>
        <p><span>ç´§æ€¥è”ç³»äºº:</span></p>
        <p><span>ç´§æ€¥è”ç³»äººç”µè¯:</span></p>
        <p><span>è¯·å‡ç†ç”±:</span></p>
        <p><span>è¯·å‡çŠ¶æ€:</span> <span style="color: rgb(34, 142, 241);">å®¡æ ¸é€šè¿‡</span></p>
        <p><span>é”€å‡çŠ¶æ€:</span></p>
        <p><span>è¯·å‡é™„ä»¶:</span></p>
    </div>

<div style="height: 0.75em; background-color: #f3f4f8; width: 100vw; position: absolute; left: 0; margin-top: -0.75em;"></div>

    <div class="progress">
        <h3 style="font-size: 1.04em; margin-left: 0.5em;">åŠç†è¿›åº¦</h3>

        <!-- æ­¥éª¤1ï¼šç”³è¯· -->
        <div style="align-items: center;">
            <span class="check-mark">âœ“</span>
            <p>ç”³è¯· <span style="color: rgb(76,208,125);">ç”³è¯·</span></p>
            <p class="time">2025-06-06 14:53</p>
        </div>

        <p class="sub-info">å§“å</p>

        <!-- æ­¥éª¤2ï¼šè¾…å¯¼å‘˜å®¡æ ¸ -->
        <div style="align-items: center;">
            <span class="check-mark">âœ“</span>
            <p>è¾…å¯¼å‘˜å®¡æ ¸ <span style="color: rgb(76,208,125);">å®¡æ ¸é€šè¿‡</span></p>
            <p class="time">2025-09-05 18:59</p>
        </div>

        <div class="sub-info-row">
            <p>è¾…å¯¼å‘˜</p>
            <p style="color: rgb(34, 142, 241);">åŒæ„</p>
        </div>

        <!-- æ­¥éª¤3ï¼šç»“æŸ -->
        <div style="align-items: center;">
            <span class="dot-mark">
                <span></span>
            </span>
            <p style="margin: 0; font-size: 0.96em;">ç»“æŸ</p>
        </div>
    </div>
</div>
</body>
</html>
