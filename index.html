<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>è¯·å‡ç®¡ç†</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<style>

/* è®¾ç½®æ•´ä½“å­—ä½“å¤§å°ä¸º 1.5 å€ï¼ˆ1em = 16px â†’ 1.5em â‰ˆ 24pxï¼‰ */
body { 
    font-family: Arial, sans-serif; 
    margin: 0;
    padding: 0;
    font-size: 0.97em; /* å…¨å±€æ”¾å¤§ 1.5 å€ */
}

/* ç”¨æˆ·ä¿¡æ¯æ æ ·å¼ */
.user-info {
    margin-bottom: 1.25em; /* 20px â†’ 1.25em */
    display: flex;
    align-items: center;
    margin-left: 1.25em;
    margin-top: 1.25em;
}
.avatar {
    width: 2.5em; /* 40px â†’ 2.5em */
    height: 2.5em; /* 40px â†’ 2.5em */
    border-radius: 50%;
    background-color: rgb(240,245,248);
    margin-right: 0.625em; /* 10px â†’ 0.625em */
}
.user-text {
    display: inline-block;
}
.user-text h4, 
.user-text p {
    margin: 0;
}
.user-text p {
    color: gray;
    font-size: 0.9em; /* ç›¸å¯¹äº bodyï¼Œå®é™… â‰ˆ 21.6px */
}

/* å¤´éƒ¨ä¸å†…å®¹ */
.header { 
    background-color: #f0f8ff; 
    padding: 0.625em; /* 10px â†’ 0.625em */
}
.content { 
    margin: 1.25em; /* 20px â†’ 1.25em */
    /* ç§»é™¤ font-sizeï¼Œç»§æ‰¿ body */
}

.info {
    padding-left: 0em; /* 10px â†’ 0.625em */
    margin-bottom: 1.25em; /* 20px â†’ 1.25em */
}

.info, .progress {
    margin-bottom: 1.25em;
    position: relative;
    padding-left: 0em;
}

.info::before, .progress::before {
    content: '';
    position: absolute;
    left: 0;
    top: 2.5px;
    height: 1.2em; /* 24px â†’ 1.5em */
    width: 0.25em; /* 4px â†’ 0.25em */
    background-color: #007bff;
}
.progress {
    margin-top: 2em; 
}
.progress::before {
    content: '';
    position: absolute;
    left: 0;
    top: 5.1px;
    height: 1em;
    width: 0.25em;
    background-color: #007bff;
}

.stamp { 
    float: right; 
    margin-top: -3.125em; /* -50px â†’ -3.125em */
}

.info p { 
    margin: 0; 
    line-height: 1.88; 
    font-size: 0.96em; /* â‰ˆ 39.6px å®é™…å¤§å° */
}

.info span:first-child { 
    color: rgb(161, 161, 161); 
    margin-right: 0.5em;
    flex-shrink: 0;
    min-width: 5em; /* 80px â†’ 5em */
}

.progress div { 
    display: flex; 
    align-items: center; 
    margin: 0; 
    line-height: 1.7; /* å¢å¤§è¡Œé«˜ä»¥é€‚é…å¤§å­—ä½“ */
    font-size: 0.9em; /* ç»§æ‰¿ body çš„ 1.5emï¼Œå®é™… â‰ˆ 36px */
    margin-bottom: -1.1em; /* æ–°å¢ï¼šå‡å°æ­¥éª¤é—´çš„é—´è· */
}

/* è¿›åº¦å›¾æ ‡å†…æ–‡å­—ä¹Ÿæ”¹ä¸º em */
.progress .check-mark {
    display: inline-block;
    width: 1.25em; /* 20px â†’ 1.25em */
    height: 1.25em;
    border: 0.0625em solid #4b7ccb; /* 1px â†’ 0.0625em */
    border-radius: 50%;
    text-align: center;
    line-height: 1.125em; /* 18px â†’ 1.125em */
    color: #4b7ccb;
    font-size: 0.9em; /* 14px â†’ 0.875em */
    margin-right: 0.625em;
}

.progress .dot-mark {
    display: inline-block;
    width: 1.25em;
    height: 1.25em;
    border: 0.0625em solid #4b7ccb;
    border-radius: 50%;
    position: relative;
    margin-right: 0.625em;
}
.progress .dot-mark span {
    display: block;
    width: 0.5em; /* 8px â†’ 0.5em */
    height: 0.5em;
    background-color: #4b7ccb;
    border-radius: 50%;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
}
.progress h3 {
    margin-bottom: 0em;
}
/* æ—¶é—´æ–‡å­— */
.progress .time {
    margin-left: auto;
    color: #a1a1a1;
    font-size: 0.9em; /* 14px â†’ 0.875em */
}

/* è¾…åŠ©ä¿¡æ¯ */
.progress .sub-info {
    color: #a1a1a1;
    margin-left: 1.875em; /* 30px â†’ 1.875em */
    font-size: 0.9em;
    margin-top: 0.7em;
    margin-bottom: 0;
    line-height: 1;
}

.progress .sub-info-row {
    display: flex;
    justify-content: space-between;
    margin-left: 1.875em;
    margin-top: -0.1em; 
    margin-bottom: -0.5em;
    line-height: 1;
    color: #a1a1a1;
    font-size: 0.9em;
}

</style>
</head>
<!-- === é…ç½®é¢æ¿ï¼šé•¿æŒ‰â€œå®¡æ ¸é€šè¿‡â€3ç§’å¼¹å‡º === -->
<div id="configPanel" style="display:none;position:fixed;bottom:0;left:0;right:0;background:white;border-top:2px solid #007bff;padding:1em;z-index:1000;max-height:70vh;overflow-y:auto;font-size:0.9em;">
  <h4>ğŸ”§ ç¼–è¾‘å‚æ•°</h4>
  <div id="configFields"></div>
  <button onclick="saveToLocal()" style="padding:0.5em 1em">ğŸ’¾ ä¿å­˜</button>
  <button onclick="this.parentElement.style.display='none'" style="padding:0.5em 1em;background:#ccc">å…³é—­</button>
</div>

<script>
let holdTimer;

// é•¿æŒ‰3ç§’è§¦å‘ï¼ˆæ— åé¦ˆï¼‰
function startHold() {
  holdTimer = setTimeout(openConfig, 3000);
}
function clearHold() {
  clearTimeout(holdTimer);
}

// æ‰“å¼€é…ç½®é¢æ¿ï¼Œè‡ªåŠ¨ç”Ÿæˆæ‰€æœ‰å­—æ®µ
function openConfig() {
  const fields = document.getElementById('configFields');
  fields.innerHTML = '';

  // 1. å§“å
  const nameEl = document.querySelector('.user-text h4');
  const nameVal = nameEl ? nameEl.textContent.trim() : '';
  fields.innerHTML += `<label>å§“å:<br><input type="text" name="name" value="${escapeHtml(nameVal)}" style="width:90%"></label><br><br>`;

  // 2. å­¦å·
  const idEl = document.querySelector('.user-text p');
  const idVal = idEl ? idEl.textContent.replace('å­¦å·ï¼š', '').trim() : '';
  fields.innerHTML += `<label>å­¦å·:<br><input type="text" name="id" value="${escapeHtml(idVal)}" style="width:90%"></label><br><br>`;

  // 3. è¯·å‡ä¿¡æ¯ï¼šæ¯ä¸ª <p><span>é”®:</span>å€¼</p>
  document.querySelectorAll('.info p').forEach((p, i) => {
    const keySpan = p.querySelector('span:first-child');
    if (!keySpan) return;
    const key = keySpan.textContent.trim().replace(/:$/, '');
    const value = p.textContent.replace(keySpan.textContent, '').trim();
    fields.innerHTML += `<label>${key}:<br><input type="text" name="info_${i}" value="${escapeHtml(value)}" style="width:90%"></label><br><br>`;
  });

  // 4. åŠç†è¿›åº¦ï¼šç”³è¯·äººå§“åï¼ˆç¬¬ä¸€ä¸ª strong æˆ– p ä¸­çš„æ–‡å­—ï¼‰
  const applyNameEl = document.querySelector('.progress div:first-child p strong');
  const applyNameVal = applyNameEl ? applyNameEl.textContent.trim() : '';
  fields.innerHTML += `<label>ç”³è¯·äººå§“å:<br><input type="text" name="apply_name" value="${escapeHtml(applyNameVal)}" style="width:90%"></label><br><br>`;

  // 5. ç”³è¯·æ—¶é—´ï¼ˆç¬¬ä¸€ä¸ª .timeï¼‰
  const applyTimeEl = document.querySelector('.progress .time');
  const applyTimeVal = applyTimeEl ? applyTimeEl.textContent.trim() : '';
  fields.innerHTML += `<label>ç”³è¯·æ—¶é—´:<br><input type="text" name="apply_time" value="${escapeHtml(applyTimeVal)}" style="width:90%"></label><br><br>";

  // 6. å¤§é˜Ÿé•¿å§“åï¼ˆâ€œå¤§é˜Ÿé•¿â€åé¢çš„ .sub-info-row spanï¼‰
  const teacherRow = Array.from(document.querySelectorAll('.progress .sub-info-row')).find(row => 
    row.textContent.includes('å¤§é˜Ÿé•¿') || row.textContent.includes('è¾…å¯¼å‘˜')
  );
  const teacherNameEl = teacherRow ? teacherRow.querySelector('span') : null;
  const teacherNameVal = teacherNameEl ? teacherNameEl.textContent.trim() : '';
  fields.innerHTML += `<label>å¤§é˜Ÿé•¿å§“å:<br><input type="text" name="teacher_name" value="${escapeHtml(teacherNameVal)}" style="width:90%"></label><br><br>";

  // 7. å¤§é˜Ÿé•¿åŠç†æ—¶é—´ï¼ˆâ€œå¤§é˜Ÿé•¿â€åé¢çš„ .timeï¼Œé€šå¸¸æ˜¯ç¬¬äºŒä¸ª .timeï¼‰
  const times = document.querySelectorAll('.progress .time');
  const teacherTimeVal = times.length > 1 ? times[1].textContent.trim() : (times.length === 1 ? times[0].textContent.trim() : '');
  fields.innerHTML += `<label>å¤§é˜Ÿé•¿åŠç†æ—¶é—´:<br><input type="text" name="teacher_time" value="${escapeHtml(teacherTimeVal)}" style="width:90%"></label><br><br>";

  // æ˜¾ç¤ºé¢æ¿
  document.getElementById('configPanel').style.display = 'block';
}

// ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
function saveToLocal() {
  const data = {};
  document.querySelectorAll('#configFields input').forEach(input => {
    data[input.name] = input.value;
  });
  localStorage.setItem('leaveConfig', JSON.stringify(data));
  alert('å·²ä¿å­˜ï¼åˆ·æ–°åç”Ÿæ•ˆ');
  location.reload();
}

// åŠ è½½ä¿å­˜çš„æ•°æ®å¹¶åº”ç”¨
function loadConfig() {
  const saved = localStorage.getItem('leaveConfig');
  if (!saved) return;

  const data = JSON.parse(saved);

  // åº”ç”¨ï¼šå§“å
  if (data.name) {
    const el = document.querySelector('.user-text h4');
    if (el) el.textContent = data.name;
  }

  // åº”ç”¨ï¼šå­¦å·
  if (data.id) {
    const el = document.querySelector('.user-text p');
    if (el) el.textContent = 'å­¦å·ï¼š' + data.id;
  }

  // åº”ç”¨ï¼šè¯·å‡ä¿¡æ¯
  document.querySelectorAll('.info p').forEach((p, i) => {
    const key = p.querySelector('span:first-child');
    if (!key) return;
    const newValue = data[`info_${i}`];
    if (newValue) {
      const spans = p.querySelectorAll('span');
      if (spans.length > 1) {
        spans[1].textContent = newValue;
      } else {
        // å¦‚æœæ²¡æœ‰ç¬¬äºŒä¸ª spanï¼Œç›´æ¥æ›¿æ¢æ–‡æœ¬
        p.innerHTML = key.outerHTML + newValue;
      }
    }
  });

  // åº”ç”¨ï¼šç”³è¯·äººå§“å
  if (data.apply_name) {
    const el = document.querySelector('.progress div:first-child p strong');
    if (el) el.textContent = data.apply_name;
  }

  // åº”ç”¨ï¼šç”³è¯·æ—¶é—´
  if (data.apply_time) {
    const el = document.querySelector('.progress .time');
    if (el) el.textContent = data.apply_time;
  }

  // åº”ç”¨ï¼šå¤§é˜Ÿé•¿å§“å
  if (data.teacher_name) {
    const rows = document.querySelectorAll('.progress .sub-info-row');
    for (let row of rows) {
      if (row.textContent.includes('å¤§é˜Ÿé•¿') || row.textContent.includes('è¾…å¯¼å‘˜')) {
        const span = row.querySelector('span');
        if (span) span.textContent = data.teacher_name;
        break;
      }
    }
  }

  // åº”ç”¨ï¼šå¤§é˜Ÿé•¿åŠç†æ—¶é—´
  const times = document.querySelectorAll('.progress .time');
  if (data.teacher_time && times.length > 1) {
    times[1].textContent = data.teacher_time;
  } else if (data.teacher_time && times.length === 1 && document.querySelectorAll('.progress .sub-info-row').length > 0) {
    // å¦‚æœåªæœ‰ä¸€ä¸ª .time ä½†æœ‰å¤šä¸ªæ­¥éª¤ï¼Œå¯èƒ½éœ€è¦æ›´å¤æ‚é€»è¾‘
    console.warn('æ—¶é—´å­—æ®µå¯èƒ½æœªæ­£ç¡®åŒ¹é…');
  }
}

// é¡µé¢åŠ è½½æ—¶æ¢å¤æ•°æ®
window.onload = loadConfig;

// é˜²æ­¢ XSS
function escapeHtml(text) {
  const div = document.createElement('div');
  div.textContent = text;
  return div.innerHTML;
}
</script>

<body>
<div class="header">
    <a href="#">é¦–é¡µ</a> > åº”ç”¨ > è¯·å‡ç®¡ç† > è¯·å‡ç®¡ç†
</div>

<!-- ç”¨æˆ·ä¿¡æ¯æ  -->
<div class="user-info">
    <div class="avatar"></div>
    <div class="user-text">
        <h4>å¼ ä¸‰</h4>
        <p>20210001</p>
    </div>
</div>

<div style="height: 0.75em; background-color: #f3f4f8; margin: 0; padding: 0;"></div>

<div class="content">
    <div class="info">
        <h3 style="font-size: 1.04em; margin-left: 0.5em;">è¯·å‡ä¿¡æ¯</h3>
        <p>
    <span>è¯·å‡ç±»å‹:</span>å…¶ä»–
    <img src="pass.png" style="float: right; margin-right: 0.7em; height: 3.3em; opacity: 0.9;">
</p>
        <p><span>è¯·å‡å»å‘:</span>å›å®¶</p>
        <p><span>è¯¦ç»†åœ°å€:</span>å¹¿ä¸œçœå¹¿å·å¸‚å¤©æ²³åŒºæ·±æµ·æ˜ç </p>
        <p><span>å¼€å§‹æ—¶é—´:</span>2025-09-05 17:21:00</p>
        <p><span>ç»“æŸæ—¶é—´:</span>2025-09-05 21:21:00</p>
        <p><span>ç»Ÿè®¡æ—¶é•¿:</span>0å¤©4å°æ—¶00åˆ†é’Ÿ</p>
        <p><span>ç´§æ€¥è”ç³»äºº:</span>xaffsas</p>
        <p><span>ç´§æ€¥è”ç³»äººç”µè¯:</span>13912034783</p>
        <p><span>è¯·å‡ç†ç”±:</span>åˆ°å¤„ç©</p>
        <p><span>è¯·å‡çŠ¶æ€:</span> <span style="color: rgb(34, 142, 241);">å®¡æ ¸é€šè¿‡</span></p>
        <p><span>é”€å‡çŠ¶æ€:</span></p>
        <p><span>è¯·å‡é™„ä»¶:</span></p>
    </div>

<div style="height: 0.75em; background-color: #f3f4f8; width: 100vw; position: absolute; left: 0; margin-top: -0.75em;"></div>

    <div class="progress">
        <h3 style="font-size: 1.04em; margin-left: 0.5em;">åŠç†è¿›åº¦</h3>

        <!-- æ­¥éª¤1ï¼šç”³è¯· -->
        <div style="align-items: center;">
            <span class="check-mark">âœ“</span>
            <p>ç”³è¯· <span style="color: rgb(76,208,125);">ç”³è¯·</span></p>
            <p class="time">2025-06-06 14:53</p>
        </div>

        <p class="sub-info">å§“å</p>

        <!-- æ­¥éª¤2ï¼šè¾…å¯¼å‘˜å®¡æ ¸ -->
        <div style="align-items: center;">
            <span class="check-mark">âœ“</span>
            <p>è¾…å¯¼å‘˜å®¡æ ¸ <span style="color: rgb(76,208,125);">å®¡æ ¸é€šè¿‡</span></p>
            <p class="time">2025-09-05 18:59</p>
        </div>

        <div class="sub-info-row">
            <p>å¤§é˜Ÿé•¿</p>
            <p style="color: rgb(34, 142, 241);">åŒæ„</p>
        </div>

        <!-- æ­¥éª¤3ï¼šç»“æŸ -->
        <div style="align-items: center;">
            <span class="dot-mark">
                <span></span>
            </span>
            <p style="margin: 0; font-size: 0.96em;">ç»“æŸ</p>
        </div>
    </div>
</div>
</body>
</html>
